<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Вход — Miyamoto Mining</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
</head>
<body class="bg-gradient-to-b from-black to-gray-900 text-white min-h-screen flex items-center justify-center p-4">

  <div class="bg-gray-800 rounded-2xl p-8 max-w-md w-full shadow-lg">
    <h1 class="text-3xl font-bold text-center mb-6">Вход в майнинг</h1>
    <p class="text-sm text-gray-400 text-center mb-6">
      Введите адрес вашего Solana кошелька, чтобы начать.
    </p>

    <input id="wallet" type="text" placeholder="Ваш Solana адрес" 
           class="w-full p-3 rounded-md bg-gray-700 text-white focus:outline-none mb-4" />

    <button onclick="login()" class="w-full bg-purple-600 hover:bg-purple-700 transition-all text-white font-bold py-3 rounded-md">
      Войти
    </button>
  </div>

  <script>
    // Firebase конфиг
    const firebaseConfig = {
      apiKey: "AIzaSyBWWqOaYvDtjtMynOwZ3hRy5vt2nmzMgFM",
      authDomain: "miyamoto-project.firebaseapp.com",
      projectId: "miyamoto-project",
      storageBucket: "miyamoto-project.appspot.com",
      messagingSenderId: "266668256982",
      appId: "1:266668256982:web:64957d8c366d80b1196377",
      measurementId: "G-VSQJLR6GR9",
      databaseURL: "https://miyamoto-project-default-rtdb.firebaseio.com"
    };

    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    function login() {
      const wallet = document.getElementById("wallet").value.trim();

      if (!wallet) {
        alert("Пожалуйста, введите адрес кошелька.");
        return;
      }

      const userRef = database.ref("users/" + wallet);

      userRef.once("value").then(snapshot => {
        if (!snapshot.exists()) {
          // создаем нового пользователя
          userRef.set({
            wallet: wallet,
            balance: 0,
            totalMinedTime: 0
          });
        }

        localStorage.setItem("wallet", wallet);
        window.location.href = "dashboard.html";
      }).catch(error => {
        console.error("Ошибка при логине:", error);
        alert("Произошла ошибка. Попробуйте позже.");
      });
    }
  </script>

</body>
</html>
